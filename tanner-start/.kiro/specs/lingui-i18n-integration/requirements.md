# Requirements Document

## Introduction

Интеграция библиотеки Lingui для интернационализации (i18n) React-приложения. Lingui выбрана как легковесное решение (~3 KB) с полной поддержкой TypeScript, ICU MessageFormat для плюрализации и интерполяции переменных. Библиотека обеспечивает типобезопасность переводов, автоматическую экстракцию сообщений и удобный API для работы с переводами.

## Requirements

### Requirement 1: Базовая настройка Lingui

**User Story:** Как разработчик, я хочу установить и настроить Lingui в проекте, чтобы начать использовать интернационализацию.

#### Acceptance Criteria

1. WHEN установлены зависимости `@lingui/core`, `@lingui/react`, `@lingui/macro`, `@lingui/cli` THEN проект имеет все необходимые пакеты для работы с Lingui
2. WHEN создан конфигурационный файл `lingui.config.ts` THEN он содержит настройки локалей (ru, en), путей к каталогам переводов и формата сообщений
3. WHEN добавлены npm-скрипты для работы с переводами THEN доступны команды для экстракции (`extract`), компиляции (`compile`) и проверки переводов
4. WHEN настроен Vite для работы с Lingui макросами THEN макросы корректно трансформируются в production-код

### Requirement 2: Инициализация i18n и интеграция с TanStack Router

**User Story:** Как разработчик, я хочу инициализировать i18n и интегрировать его с TanStack Router, чтобы локаль управлялась через роутинг и все компоненты имели доступ к переводам.

#### Acceptance Criteria

1. WHEN создан модуль `src/i18n/index.ts` с инициализацией i18n THEN он экспортирует настроенный экземпляр i18n и функции для работы с локалями
2. WHEN i18n интегрирован с TanStack Router THEN локаль определяется из URL параметров (например, `/ru/dashboard`, `/en/dashboard`)
3. WHEN загружаются скомпилированные каталоги переводов THEN они динамически подгружаются для активной локали через `i18n.load()` и `i18n.activate()`
4. WHEN устанавливается начальная локаль THEN она определяется из URL, затем из localStorage, затем из браузерных настроек с fallback на 'ru'
5. WHEN локаль изменяется через роутер THEN автоматически загружаются соответствующие переводы и обновляется i18n контекст

### Requirement 3: Типизация переводов

**User Story:** Как разработчик, я хочу иметь типобезопасность при работе с переводами, чтобы избежать ошибок с несуществующими ключами.

#### Acceptance Criteria

1. WHEN используется TypeScript THEN IDE предоставляет автокомплит для ключей переводов
2. WHEN используется несуществующий ключ перевода THEN TypeScript выдает ошибку на этапе компиляции
3. WHEN используется интерполяция переменных THEN TypeScript проверяет типы передаваемых параметров
4. WHEN создается файл типов `src/i18n/types.ts` THEN он содержит типы для всех доступных локалей и ключей переводов

### Requirement 4: Плюрализация

**User Story:** Как разработчик, я хочу использовать плюрализацию для корректного отображения форм слов в зависимости от числа, чтобы пользователи видели грамматически правильный текст.

#### Acceptance Criteria

1. WHEN используется макрос `plural` с числом THEN система автоматически выбирает правильную форму слова (one/few/many/other)
2. WHEN число равно 1 THEN отображается форма "1 день"
3. WHEN число равно 2-4 THEN отображается форма "2 дня"
4. WHEN число равно 5+ THEN отображается форма "5 дней"
5. WHEN используется символ `#` в сообщении THEN он заменяется на отформатированное число

### Requirement 5: Интерполяция переменных

**User Story:** Как разработчик, я хочу вставлять динамические значения в переводы, чтобы создавать персонализированные сообщения.

#### Acceptance Criteria

1. WHEN используется макрос `t` с template literal THEN переменные корректно интерполируются в строку
2. WHEN передается строковая переменная (например, имя) THEN она вставляется в нужное место перевода
3. WHEN передается числовая переменная THEN она форматируется согласно локали
4. WHEN используется компонент `<Trans>` с JSX THEN React-компоненты корректно встраиваются в перевод

### Requirement 6: Переключение языка через роутинг

**User Story:** Как пользователь, я хочу переключать язык интерфейса через URL, чтобы использовать приложение на удобном мне языке и иметь возможность делиться ссылками с нужной локалью.

#### Acceptance Criteria

1. WHEN пользователь выбирает язык из списка доступных THEN происходит навигация на URL с новой локалью (например, с `/ru/dashboard` на `/en/dashboard`)
2. WHEN язык изменяется через URL THEN выбор сохраняется в localStorage для последующих визитов
3. WHEN пользователь открывает приложение без указания локали в URL THEN происходит редирект на URL с локалью из localStorage или браузерных настроек
4. WHEN создан компонент `LanguageSwitcher` THEN он использует TanStack Router для навигации между локалями
5. WHEN пользователь делится ссылкой с локалью THEN получатель видит контент на указанном языке

### Requirement 7: Организация переводов

**User Story:** Как разработчик, я хочу иметь структурированную систему хранения переводов, чтобы легко находить и обновлять тексты.

#### Acceptance Criteria

1. WHEN переводы организованы по неймспейсам THEN каждый модуль/фича имеет свою группу переводов
2. WHEN используется команда `lingui extract` THEN все сообщения автоматически извлекаются из кода в каталоги
3. WHEN файлы переводов находятся в `src/locales/{locale}/messages.po` THEN они доступны для редактирования переводчиками
4. WHEN используется команда `lingui compile` THEN .po файлы компилируются в оптимизированный JavaScript формат

### Requirement 8: Примеры использования

**User Story:** Как разработчик, я хочу иметь примеры использования Lingui в разных сценариях, чтобы быстро понять как применять библиотеку.

#### Acceptance Criteria

1. WHEN создан компонент `I18nExample` THEN он демонстрирует базовый перевод с макросом `t`
2. WHEN создан пример плюрализации THEN он показывает работу с разными числами (1, 2, 5, 24)
3. WHEN создан пример интерполяции THEN он демонстрирует вставку строк и чисел в переводы
4. WHEN создан пример с компонентом `<Trans>` THEN он показывает встраивание React-компонентов в переводы
5. WHEN примеры добавлены в роутинг THEN они доступны по пути `/examples/i18n`

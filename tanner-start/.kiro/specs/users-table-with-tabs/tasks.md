# План реализации

- [x] 1. Создать типы и Zod схемы для данных пользователей



  - Создать файл `src/types/users.ts` с типами User, UsersListResponse, UsersListParams
  - Создать файл `src/lib/schemas/usersSchema.ts` с Zod схемами для валидации search параметров и формы фильтров
  - Использовать `type` вместо `interface` для всех определений типов
  - _Требования: 1.1, 2.2, 9.4_

- [x] 2. Создать структуру маршрутов для страницы пользователей


  - [x] 2.1 Создать корневой маршрут `src/routes/$locale/_layout/users/index.tsx` с редиректом на table





    - Реализовать редирект на вкладку table по умолчанию
    - _Требования: 4.1_



  - [ ] 2.2 Создать маршрут таблицы `src/routes/$locale/_layout/users/table.tsx`
    - Настроить Zod схему для валидации search параметров (page, pageSize, sortBy, sortOrder, фильтры)
    - Использовать `validateSearch` в конфигурации маршрута
    - Реализовать компонент UsersTablePage с навигацией по вкладкам
    - Добавить кнопку CREATE с локализацией




    - _Требования: 1.3, 4.1, 4.2, 4.3, 9.1, 9.2, 9.3, 9.4, 9.5_

  - [ ] 2.3 Создать маршрут заглушки `src/routes/$locale/_layout/users/placeholder.tsx`
    - Реализовать PlaceholderPage с локализованным сообщением "Страница в разработке"
    - Использовать Trans компонент для всех текстов
    - _Требования: 4.4, 5.1, 5.2, 5.3_



- [ ] 3. Создать API хук для загрузки данных пользователей
  - Создать файл `src/hooks/api/useUsers.ts` с хуком useUsers
  - Использовать TanStack Query (useQuery) для загрузки данных
  - Настроить правильные query keys для кэширования
  - Реализовать функцию fetchUsers для API запросов с поддержкой пагинации, сортировки и фильтров



  - Настроить staleTime и gcTime для оптимального кэширования
  - _Требования: 1.2, 8.1, 8.2, 8.3, 8.4, 8.5_

- [ ] 4. Создать компонент определения колонок таблицы
  - Создать файл `src/components/users/UsersTableColumns.tsx`
  - Определить все 12 колонок с использованием ColumnDef из TanStack Table
  - Добавить локализацию для всех заголовков колонок используя Trans



  - Реализовать форматирование дат с использованием Intl.DateTimeFormat и текущей локали
  - Настроить сортировку для всех колонок кроме Options
  - _Требования: 1.1, 3.1, 3.2_

- [ ] 5. Создать основной компонент таблицы UsersTable
  - Создать файл `src/components/users/UsersTable.tsx`
  - Использовать useReactTable из @tanstack/react-table


  - Интегрировать определения колонок из UsersTableColumns
  - Реализовать управляемую пагинацию и сортировку через пропсы
  - Добавить состояния загрузки, ошибки и пустых данных с локализацией
  - Использовать shadcn/ui компоненты Table для UI
  - Добавить адаптивность с горизонтальной прокруткой
  - _Требования: 1.1, 1.2, 3.3, 3.4, 7.1, 7.2, 7.3, 7.4, 8.2, 8.3_

- [x] 6. Создать компонент фильтрации UsersTableFilters


  - Создать файл `src/components/users/UsersTableFilters.tsx`
  - Использовать React Hook Form с zodResolver для управления формой
  - Создать поля ввода для всех фильтров (phone, id, email, firstName, lastName, registrationDate, isInsider, country, domain, isRealAccountCreated, isDemoAccountCreated)
  - Добавить локализацию для всех лейблов и placeholder текстов используя Trans и t макросы
  - Реализовать обновление URL параметров при изменении фильтров



  - Добавить кнопку сброса фильтров с локализацией
  - Использовать shadcn/ui компоненты Input для полей формы
  - _Требования: 2.1, 2.2, 2.3, 2.4, 2.5_

- [ ] 7. Создать компонент пагинации UsersTablePagination
  - Создать файл `src/components/users/UsersTablePagination.tsx`
  - Реализовать отображение текущего диапазона записей с локализацией
  - Добавить выбор количества строк на странице (10, 20, 50, 100)
  - Создать кнопки навигации (первая, предыдущая, следующая, последняя страница)
  - Реализовать обновление URL параметров при изменении пагинации
  - Использовать Trans и t макросы для всех текстов
  - Использовать shadcn/ui компоненты Select и Button
  - _Требования: 1.4, 1.5_

- [ ] 8. Создать компонент действий UsersTableActions
  - Создать файл `src/components/users/UsersTableActions.tsx`
  - Добавить иконки действий (просмотр, редактирование, удаление)
  - Использовать lucide-react для иконок
  - Реализовать обработчики для каждого действия
  - _Требования: 6.1, 6.2, 6.3, 6.4_

- [ ] 9. Интегрировать все компоненты в UsersTablePage
  - Обновить `src/routes/$locale/_layout/users/table.tsx`
  - Получить search параметры из URL используя useSearch
  - Вызвать useUsers хук с параметрами из URL
  - Передать данные, состояния загрузки и ошибки в UsersTable
  - Интегрировать UsersTableFilters для фильтрации
  - Интегрировать UsersTablePagination для пагинации
  - Реализовать обработчики изменения пагинации и сортировки с обновлением URL
  - Добавить навигацию по вкладкам с локализацией
  - _Требования: 1.2, 2.3, 3.3, 3.4, 4.1, 4.2, 4.3, 4.5_

- [ ] 10. Добавить локализационные строки
  - Извлечь все строки для перевода используя `lingui extract`
  - Добавить переводы для русской и английской локалей
  - Скомпилировать переводы используя `lingui compile`
  - _Требования: все требования с локализацией_

- [x] 11. Написать unit тесты для Zod схем и утилит


  - [x] 11.1 Создать тесты для usersSchema.ts


    - Тестировать валидацию search параметров
    - Тестировать валидацию формы фильтров
    - Тестировать fallback на значения по умолчанию
    - _Требования: 2.2, 9.1, 9.2, 9.3, 9.5_


  - [x] 11.2 Создать тесты для функции форматирования дат

    - Тестировать форматирование для разных локалей
    - Тестировать обработку невалидных дат
    - _Требования: 1.1_

- [ ] 12. Написать component тесты для компонентов таблицы
  - [x] 12.1 Создать тесты для UsersTable.tsx



    - Тестировать рендеринг таблицы с моковыми данными
    - Тестировать отображение состояния загрузки
    - Тестировать отображение состояния ошибки
    - Тестировать отображение пустого состояния
    - Тестировать клик по заголовкам колонок для сортировки
    - _Требования: 1.1, 3.1, 3.2, 8.2, 8.3_

  - [x] 12.2 Создать тесты для UsersTableFilters.tsx


    - Тестировать рендеринг всех полей фильтров
    - Тестировать валидацию формы
    - Тестировать сброс фильтров
    - Тестировать обновление URL при изменении фильтров
    - _Требования: 2.1, 2.2, 2.3_

  - [ ] 12.3 Создать тесты для UsersTablePagination.tsx
    - Тестировать отображение текущего диапазона
    - Тестировать изменение количества строк на странице
    - Тестировать навигацию по страницам
    - Тестировать обновление URL при изменении пагинации
    - _Требования: 1.4, 1.5_

  - [ ] 12.4 Создать тесты для UsersTableActions.tsx
    - Тестировать рендеринг иконок действий
    - Тестировать клики по кнопкам действий
    - _Требования: 6.1, 6.2, 6.3_

- [ ] 13. Написать integration тесты для страницы пользователей
  - [ ] 13.1 Создать тесты для навигации между вкладками
    - Тестировать переключение между вкладками table и placeholder
    - Тестировать сохранение search параметров при переключении вкладок
    - Тестировать выделение активной вкладки
    - _Требования: 4.1, 4.2, 4.3, 4.4, 4.5_

  - [ ] 13.2 Создать тесты для синхронизации URL и состояния таблицы
    - Тестировать загрузку данных при изменении URL параметров
    - Тестировать обновление URL при взаимодействии с таблицей
    - Тестировать сохранение состояния при навигации назад/вперед
    - _Требования: 3.3, 3.4, 9.1, 9.2, 9.3_

  - [ ] 13.3 Создать тесты для взаимодействия фильтров с таблицей
    - Тестировать применение фильтров и обновление таблицы
    - Тестировать сброс фильтров
    - Тестировать комбинацию фильтров с пагинацией и сортировкой
    - _Требования: 2.3, 2.4_

- [ ] 14. Написать тесты для useUsers хука
  - Создать тесты для успешной загрузки данных
  - Тестировать обработку ошибок загрузки
  - Тестировать кэширование данных
  - Тестировать передачу параметров пагинации, сортировки и фильтров в API
  - _Требования: 8.1, 8.2, 8.3, 8.4, 8.5_

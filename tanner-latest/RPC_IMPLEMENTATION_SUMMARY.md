# ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ RPC API (–µ–¥–∏–Ω—ã–π POST endpoint)

## üéØ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–±–æ—Ç—ã —Å –±—ç–∫–µ–Ω–¥–æ–º, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–µ–¥–∏–Ω—ã–π POST endpoint** –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (RPC-style API).

## üì¶ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –û—Å–Ω–æ–≤–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:

1. **src/shared/api/rpc-base-query.ts**
   - Custom `baseQuery` –¥–ª—è RPC-style API
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –æ–¥–∏–Ω endpoint –º–µ—Ç–æ–¥–æ–º POST
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç —Ç–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
   - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ RPC

2. **src/shared/api/rpc-api.example.ts**
   - –ì–æ—Ç–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä API —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏
   - CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - –ü—Ä–∏–º–µ—Ä—ã —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
   - –ü–æ–ª–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è TypeScript

3. **src/components/RPCExample.tsx**
   - –ü—Ä–∏–º–µ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É—é—â–µ–≥–æ RPC API
   - –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã —Å query –∏ mutation
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:

4. **RPC_API_GUIDE.md** - –ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
5. **RPC_QUICK_START.md** - –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –û–±–Ω–æ–≤–ª–µ–Ω–æ:

6. **src/shared/store/index.ts** - –¥–æ–±–∞–≤–ª–µ–Ω rpcApi –≤ store

## üîÑ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ó–∞–ø—Ä–æ—Å:
```
POST /api/rpc
Content-Type: application/json

{
  "method": "users.list",
  "params": {
    "limit": 10,
    "offset": 0
  }
}
```

### –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç:
```json
{
  "result": [
    { "id": 1, "name": "John" }
  ]
}
```

### –û—Ç–≤–µ—Ç —Å –æ—à–∏–±–∫–æ–π:
```json
{
  "error": {
    "code": 403,
    "message": "Access denied"
  }
}
```

## üí° –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –°–æ–∑–¥–∞–π—Ç–µ API:

```typescript
import { createApi } from '@reduxjs/toolkit/query/react'
import { createRPCBaseQuery } from './rpc-base-query'

export const myApi = createApi({
  reducerPath: 'myApi',
  baseQuery: createRPCBaseQuery('/api', '/rpc'),
  endpoints: (build) => ({
    getUsers: build.query<User[], void>({
      query: () => ({
        method: 'users.list',
        params: {},
      }),
    }),
  }),
})
```

### 2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö:

```typescript
function Users() {
  const { data, error, isLoading } = useGetUsersQuery()

  if (isLoading) return <div>–ó–∞–≥—Ä—É–∑–∫–∞...</div>
  if (error) return <div>–û—à–∏–±–∫–∞</div>

  return (
    <div>
      {data?.map(user => <div key={user.id}>{user.name}</div>)}
    </div>
  )
}
```

## ‚ú® –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

‚úÖ **–ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞** - –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –æ–¥–∏–Ω URL  
‚úÖ **–ì–∏–±–∫–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã  
‚úÖ **–¢–∏–ø–∏–∑–∞—Ü–∏—è** - –ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ TypeScript  
‚úÖ **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ RTK Query  
‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º middleware  
‚úÖ **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç —Ç–æ–∫–µ–Ω  

## üé® –ü—Ä–∏–º–µ—Ä—ã –º–µ—Ç–æ–¥–æ–≤

### CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏:
```typescript
// –°–ø–∏—Å–æ–∫
{ method: 'users.list', params: {} }

// –ü–æ–ª—É—á–µ–Ω–∏–µ
{ method: 'users.get', params: { id: 123 } }

// –°–æ–∑–¥–∞–Ω–∏–µ
{ method: 'users.create', params: { name: 'John' } }

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ
{ method: 'users.update', params: { id: 123, name: 'John Doe' } }

// –£–¥–∞–ª–µ–Ω–∏–µ
{ method: 'users.delete', params: { id: 123 } }
```

### –°–ª–æ–∂–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:
```typescript
// –ü–æ–∏—Å–∫ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
{
  method: 'users.search',
  params: {
    query: 'john',
    filters: { role: 'admin' },
    limit: 10
  }
}

// –ü–∞–∫–µ—Ç–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
{
  method: 'users.batchUpdate',
  params: {
    ids: [1, 2, 3],
    data: { status: 'active' }
  }
}
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ò–∑–º–µ–Ω–∏—Ç—å endpoint:
```typescript
createRPCBaseQuery('/api', '/rpc')  // ‚Üê –≤–∞—à –ø—É—Ç—å
```

### –ò–∑–º–µ–Ω–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç –∑–∞–ø—Ä–æ—Å–∞:
–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `src/shared/api/rpc-base-query.ts`

### –î–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏:
```typescript
headers: {
  'Content-Type': 'application/json',
  'X-Custom-Header': 'value',
  Authorization: `Bearer ${token}`,
}
```

## üõ°Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç **—Ç–æ—á–Ω–æ —Ç–∞–∫ –∂–µ**, –∫–∞–∫ –∏ —Å REST API:

### –ì–ª–æ–±–∞–ª—å–Ω–æ (middleware):
- **401** ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/login`
- **500+** ‚Üí –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö –æ—à–∏–±–æ–∫
- **FETCH_ERROR** ‚Üí –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫

### –õ–æ–∫–∞–ª—å–Ω–æ (–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã):
- **403** ‚Üí –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞
- **404** ‚Üí –º–µ—Ç–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω
- **422** ‚Üí –æ—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

```typescript
if (error && 'status' in error) {
  if (error.status === 403) {
    return <div>–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞</div>
  }
}
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç:
- **RPC_QUICK_START.md** - –Ω–∞—á–Ω–∏—Ç–µ –æ—Ç—Å—é–¥–∞!

### –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- **RPC_API_GUIDE.md** - –ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ —Å–æ –≤—Å–µ–º–∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏

### –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞:
- `src/shared/api/rpc-api.example.ts` - –≥–æ—Ç–æ–≤—ã–µ –ø—Ä–∏–º–µ—Ä—ã –º–µ—Ç–æ–¥–æ–≤
- `src/components/RPCExample.tsx` - –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

## üöÄ –ß—Ç–æ –¥–∞–ª—å—à–µ?

1. –°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–π RPC API –≤ `src/shared/api/`
2. –î–æ–±–∞–≤—å—Ç–µ –µ–≥–æ –≤ store
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ö—É–∫–∏ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
4. –ù–∞—Å–ª–∞–∂–¥–∞–π—Ç–µ—Å—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫!

## üí¨ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

–†–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º RPC-style API:
- JSON-RPC 2.0
- Custom RPC –ø—Ä–æ—Ç–æ–∫–æ–ª—ã
- GraphQL (—Å –Ω–µ–±–æ–ª—å—à–∏–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏)
- –õ—é–±–æ–π –¥—Ä—É–≥–æ–π —Ñ–æ—Ä–º–∞—Ç —Å –µ–¥–∏–Ω—ã–º POST endpoint

–ü—Ä–æ—Å—Ç–æ –∞–¥–∞–ø—Ç–∏—Ä—É–π—Ç–µ `rpc-base-query.ts` –ø–æ–¥ –≤–∞—à —Ñ–æ—Ä–º–∞—Ç!
